<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mining Laser Setup</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <button id="darkModeToggle" class="dark-mode-toggle">ðŸŒ™</button>
  <div class="tabs">
    <button class="tab-button active" data-tab="mining-laser">Mining Laser Setup</button>
    <button class="tab-button" data-tab="breakability">Breakability Chart</button>
    <button class="tab-button" data-tab="about">About</button>
  </div>

  <div class="tab-content" id="mining-laser">
    <button id="addLaserheadBtn">Add Laserhead</button>
    <button id="displayOptionsBtn">Display Options</button>
    <div id="selectedList"></div>
    <div id="footerContainer"></div>
  </div>

  <div class="tab-content hidden" id="breakability">
  <!-- Removed redundant chart tab title -->
    <div class="chart-container">
        <canvas id="miningChart"></canvas>
    </div>
    <div class="chart-controls">
        <div class="gadget-selector">
            <label for="gadgetSelect">Gadget:</label>
            <select id="gadgetSelect">
                <option value="none">None</option>
            </select>
        </div>
        <div class="marker-inputs">
            <div class="input-group">
                <label for="massInput">Mass:</label>
                <input type="number" id="massInput" step="0.1" min="0" placeholder="0">
            </div>
            <div class="input-group">
                <label for="resistanceInput" id="resistanceLabel">Base Resistance (%):</label>
                <input type="number" id="resistanceInput" step="0.1" min="0" max="100" placeholder="0">
            </div>
            <div class="input-group">
                <label>Required Power:</label>
                <div id="requiredPowerDisplay">-</div>
            </div>
        </div>
    </div>
    <div id="footerContainer"></div>
  </div>

  <div class="tab-content hidden" id="about">
  <!-- Removed redundant about tab title -->
    <div class="about-content">
      <div class="about-section">
        <h3>Mining Laser Breakability Chart</h3>
        <p>This tool provides an interactive way to explore and analyze mining laser equipment configurations in Star Citizen. It allows you to:</p>
        <ul>
          <li><strong>Setup Mining Lasers:</strong> Configure laserheads and modules to create custom mining laser setups.</li>
          <li><strong>Compare Breakability:</strong> View detailed breakability charts! Here you get a visual representation of all the Rocks you can crack with your setup.</li>
          <li><strong>Optimize Configurations:</strong> Experiment with different gadgets and modules to find the best setup for your needs.</li>
        </ul>
      </div>
      <div class="about-section">
        <h3>How It Works</h3>
        <p><strong>Mining Laser Setup Tab:</strong></p>
        <ul>
          <li>Click "Add Laserhead" to select a laserhead and customize its configuration.</li>
          <li>For each laserhead, you can add multiple modules to enhance its capabilities.</li>
          <li>Rename Laserhead names and deactivate active modules by clicking on them.</li>
          <li>Use "Display Options" to show/hide specific attributes.</li>
        </ul>
        <p><strong>Breakability Chart Tab:</strong></p>
        <ul>
          <li>On the X axis you see the resistance in %, on the Y axis the mass. The breakability only depends on these two values.</li>
          <li>The chart shows the maximum mass/resistance rocks you can break with your setup.</li>
          <li>The base rock values are the one you see e.g. from the moles pilot seat. Only unmodified numbers appear white ingame. You can toggle to the modifed resistance by clicking in the x axis label.</li>
          <li>You can deactivate a laser by clicking on its name in the legend.</li>
          <li>Use the gadget selector to see how breakability changes with different gadgets.</li>
          <li>You can enter the mass and resistance of a rock and see how much percentage of your laserpower you need to apply.</li>

        </ul>
        <p><strong>Notes</strong></p>
        <ul>
          <li>If you find any bugs, feel free to contact me. You can find me on my orgs or on regoliths discord.</li>
          <li>All the calculations are based upon my research. You can find my write up <a href="https://drive.google.com/drive/folders/1syb6-Rdbl8MNEfujI-6HPk3sXWa4VB1r?usp=sharing">here</a>. Please comment or shoot me a message if things are unclear.</li>
          <li>The instability does not play a role on the breakability but together with the charging window it dictates how easy to break it is.</li>
          <li>Every miner should choose instability modifiers suitable for their needs. This is hard to quantify.</li>
          <li>More features like time to break of a subjective difficulty score might be implemented at a later stage</li>
        </ul>
      </div>
      <div class="about-section">
        <p>Your laser setups and preferences are automatically saved in your browser.</p>
        <button id="clearCacheBtn" class="btn-delete">Clear All Saved Data</button>
        <p style="font-size: 0.9em; color: var(--color-text-muted); margin-top: 10px;">This will reset all laser setups, filters, and preferences to defaults.</p>
      </div>
    </div>
    <div id="footerContainer"></div>
  </div>

  <!-- Laserhead Selection Modal -->
  <div id="laserheadModal" class="hidden">
    <div class="modal-content">
      <button id="closeModalBtn">âœ•</button>
      <div class="filter-buttons">
        <button class="sizeFilter" data-size="1">S1</button>
        <button class="sizeFilter" data-size="2">S2</button>
      </div>
      <div id="laserheadCards"></div>
    </div>
  </div>

  <!-- Display Options Modal -->
  <div id="displayOptionsModal" class="hidden">
    <div class="modal-content">
      <button id="closeDisplayOptionsBtn">âœ•</button>
      <div class="display-options-container">
        <div class="display-options-column">
          <h3>Laserhead Attributes</h3>
          <div id="displayOptionsCheckboxes"></div>
        </div>
        <div class="display-options-column">
          <h3>Module Attributes</h3>
          <div id="moduleOptionsCheckboxes"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Module Selection Modal -->
  <div id="moduleModal" class="hidden">
    <div class="modal-content">
      <button id="closeModuleModalBtn">âœ•</button>
      <h3>Select Module</h3>
      <div class="filter-buttons">
        <button class="moduleTypeFilter" data-type="active">Active</button>
        <button class="moduleTypeFilter" data-type="passive">Passive</button>
      </div>
      <div class="filter-buttons" id="tierFilterButtons" style="display: none;">
        <button class="tierFilter" data-tier="1">Tier 1</button>
        <button class="tierFilter" data-tier="2">Tier 2</button>
        <button class="tierFilter" data-tier="3">Tier 3</button>
      </div>
      <div id="moduleCards"></div>
    </div>
  </div>

  <!-- Footer Template -->
  <template id="footerTemplate">
    <div class="about-footer">
      <span class="footer-dev">
        Developed by Mort13
        <a href="https://discord.gg/rosenrudel" target="_blank" rel="noopener noreferrer">
          <img src="data/rosenrudel.png" alt="Rosenrudel Logo" class="rosenrudel-logo">
        </a>
      </span>
      <span class="footer-powered">
        Powered by
        <a href="https://uexcorp.space/" target="_blank" rel="noopener noreferrer">
          <img src="data/logo-black.png" alt="UEX Corp Logo" class="uex-logo">
        </a>
      </span>
    </div>
  </template>

  <!-- Load main script as a module -->
  <script type="module" src="js/main.js"></script>
</body>
</html>
